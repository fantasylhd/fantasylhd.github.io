<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>day41Filter-Listener-BaseServlet | fantasyblog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="day41Filter &amp; Listener &amp; BaseServlet1.1 过滤器Filter1.1.1 Filter简介filter是对客户端访问资源的过滤，符合条件放行，不符合条件不放行  1.1.2 快速入门使用步骤 编写一个过滤器的类实现Filter接口 实现接口中尚未实现的方法(着重实现doFilter方法) 在web.xml中（注解）进行配置(主要是配置要对哪些资源">
<meta property="og:type" content="article">
<meta property="og:title" content="day41Filter-Listener-BaseServlet">
<meta property="og:url" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/index.html">
<meta property="og:site_name" content="fantasyblog">
<meta property="og:description" content="day41Filter &amp; Listener &amp; BaseServlet1.1 过滤器Filter1.1.1 Filter简介filter是对客户端访问资源的过滤，符合条件放行，不符合条件不放行  1.1.2 快速入门使用步骤 编写一个过滤器的类实现Filter接口 实现接口中尚未实现的方法(着重实现doFilter方法) 在web.xml中（注解）进行配置(主要是配置要对哪些资源">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/1.png">
<meta property="og:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/2.png">
<meta property="og:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/3.png">
<meta property="og:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/4.png">
<meta property="og:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/5.jpg">
<meta property="article:published_time" content="2020-04-12T09:36:46.000Z">
<meta property="article:modified_time" content="2020-04-12T11:49:00.096Z">
<meta property="article:author" content="fantasy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fantasylhd.github.io/2020/04/12/day41filter-listener-baseservlet/1.png">
  
    <link rel="alternate" href="/atom.xml" title="fantasyblog" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-day41Filter-Listener-BaseServlet" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      day41Filter-Listener-BaseServlet
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2020/04/12/day41filter-listener-baseservlet/" class="article-date">
  <time datetime="2020-04-12T09:36:46.000Z" itemprop="datePublished">2020-04-12</time>
</a>
    
    
  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h1 id="day41Filter-amp-Listener-amp-BaseServlet"><a href="#day41Filter-amp-Listener-amp-BaseServlet" class="headerlink" title="day41Filter &amp; Listener &amp; BaseServlet"></a>day41Filter &amp; Listener &amp; BaseServlet</h1><h2 id="1-1-过滤器Filter"><a href="#1-1-过滤器Filter" class="headerlink" title="1.1 过滤器Filter"></a>1.1 过滤器Filter</h2><h3 id="1-1-1-Filter简介"><a href="#1-1-1-Filter简介" class="headerlink" title="1.1.1 Filter简介"></a>1.1.1 Filter简介</h3><p>filter是对客户端访问资源的过滤，符合条件放行，不符合条件不放行</p>
<p><img src="/2020/04/12/day41filter-listener-baseservlet/1.png" alt></p>
<h3 id="1-1-2-快速入门"><a href="#1-1-2-快速入门" class="headerlink" title="1.1.2 快速入门"></a>1.1.2 快速入门</h3><h4 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h4><ol>
<li>编写一个过滤器的类实现Filter接口</li>
<li>实现接口中尚未实现的方法(着重实现doFilter方法)</li>
<li>在web.xml中（注解）进行配置(主要是配置要对哪些资源进行过滤)</li>
<li>在doFilter方法中书写过滤任务</li>
<li>FilterChain.doFilter方法放行</li>
</ol>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>过滤器doFilter方法默认拦截请求，如果需要经过过滤器之后，可以继续访问资源，要使用filterChain放行。</p>
<p>代码实现</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">//  初始化方法.</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyFilter.init"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest servletRequest<span class="token punctuation">,</span> ServletResponse servletResponse<span class="token punctuation">,</span> FilterChain filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyFilter.doFilter  进入过滤器 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 3. 放行 .</span>
        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span> servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 销毁方法</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyFilter.destroy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="web-xml配置"><a href="#web-xml配置" class="headerlink" title="web.xml配置"></a>web.xml配置</h4><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>filter<span class="token operator">></span>
    <span class="token operator">&lt;</span>filter‐name<span class="token operator">></span>MyFilter1<span class="token operator">&lt;</span><span class="token operator">/</span>filter‐name<span class="token operator">></span>
    <span class="token operator">&lt;</span>filter‐<span class="token keyword">class</span><span class="token operator">></span>com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>MyFilter1<span class="token operator">&lt;</span><span class="token operator">/</span>filter‐<span class="token keyword">class</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">></span>
<span class="token operator">&lt;</span>filter‐mapping<span class="token operator">></span>
    <span class="token operator">&lt;</span>filter‐name<span class="token operator">></span>MyFilter1<span class="token operator">&lt;</span><span class="token operator">/</span>filter‐name<span class="token operator">></span>
    <span class="token operator">&lt;</span>url‐pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>url‐pattern<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>filter‐mapping<span class="token operator">></span></code></pre>
<h4 id="注解配置"><a href="#注解配置" class="headerlink" title="注解配置"></a>注解配置</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/*"</span><span class="token punctuation">)</span></code></pre>
<h3 id="1-1-3-过滤器的执行流程"><a href="#1-1-3-过滤器的执行流程" class="headerlink" title="1.1.3 过滤器的执行流程"></a>1.1.3 过滤器的执行流程</h3><h4 id="图解过滤器的执行流程"><a href="#图解过滤器的执行流程" class="headerlink" title="图解过滤器的执行流程"></a>图解过滤器的执行流程</h4><p><img src="/2020/04/12/day41filter-listener-baseservlet/2.png" alt></p>
<h3 id="1-1-4-Filter的API详解"><a href="#1-1-4-Filter的API详解" class="headerlink" title="1.1.4 Filter的API详解"></a>1.1.4 Filter的API详解</h3><h4 id="filter生命周期及其与生命周期相关的方法"><a href="#filter生命周期及其与生命周期相关的方法" class="headerlink" title="filter生命周期及其与生命周期相关的方法"></a>filter生命周期及其与生命周期相关的方法</h4><p>Filter接口有三个方法，并且这个三个都是与Filter的生命相关的方法</p>
<ol>
<li><p>init(Filterconfig) ：代表filter对象初始化方法 filter对象创建时执行</p>
</li>
<li><p>doFilter(ServletRequest,ServletResponse,FilterCha) ：代表filter执行过滤的<br>核心方法，如果某资源在已经被配置到这个filter进行过滤的话，那么每次访问这个资源都会执行</p>
</li>
<li><p>destory() ：代表是filter销毁方法 当filter对象销毁时执行该方法</p>
</li>
</ol>
<p>Filter对象的生命周期:</p>
<ol>
<li>Filter何时创建：服务器启动时就创建该filter对象</li>
<li>Filter何时执行过滤：每当一个请求的路径是满足过滤器的配置路径，那么就会执行一次过滤器的doFilter方法</li>
<li>Filter何时销毁：服务器关闭时filter销毁</li>
</ol>
<h4 id="Filter的API详解"><a href="#Filter的API详解" class="headerlink" title="Filter的API详解"></a>Filter的API详解</h4><ol>
<li><p>init(FilterConfig) :Filter对象创建候，立即执行init方法参数：FilterConfig是Filter的配置对象，该对象可以获得ServletContext对象</p>
</li>
<li><p>destory() :filter对象销毁前执行destory方法</p>
</li>
<li><p>doFilter(ServletRequest,ServletResponse,FilterChain) :filter执行过滤的核心方法，如果某资源在已经被配置到这个filter进行过滤的话，那么每次访问这个资源都会执行doFilter方法</p>
</li>
</ol>
<p>参数：</p>
<ul>
<li><p>ServletRequest / ServletResponse：每次在执行doFilter方法时 web容器负责创建一个request和一个response对象作为doFilter的参数传递进来。该request与该response就是在访问目标资源的service方法时的request和response。</p>
</li>
<li><p>FilterChain：过滤器链对象，通过该对象的doFilter方法可以放行该请求</p>
</li>
</ul>
<p><img src="/2020/04/12/day41filter-listener-baseservlet/3.png" alt></p>
<h3 id="1-1-5-Filter配置"><a href="#1-1-5-Filter配置" class="headerlink" title="1.1.5 Filter配置"></a>1.1.5 Filter配置</h3><h4 id="映射路径"><a href="#映射路径" class="headerlink" title="映射路径"></a>映射路径</h4><p>xml方式配置：</p>
<p>注解配置：</p>
<p>前面已经介绍过了</p>
<p>不管是注解配置还是xml配置，配置虚拟路径的语法都是一致的，如下：</p>
<ol>
<li><p>完全匹配</p>
<p> 语法：/sertvle1</p>
<p> 只有访问的地址是servlet1时，才执行该过滤器</p>
</li>
<li><p>目录匹配</p>
<p> 语法：/aaa/bbb/* ，经常使用</p>
<p> 当访问的目标资源 的地址是/aaa/bbb/任何资源 都执行该过滤器</p>
</li>
<li><p>扩展名匹配</p>
<p> 语法：*.abc  *.jsp</p>
<p> 当访问的目标资源的扩展名是 abc、jsp时 才执行该过滤器</p>
</li>
</ol>
<h4 id="拦截方式"><a href="#拦截方式" class="headerlink" title="拦截方式"></a>拦截方式</h4><p>有了上面学习的映射路径，我们可以控制过滤器过滤指定的内容，但是我们在访问资源的时候，并不是每次都是之间访问，有时是以转发的方式访问的，这就需要我们要让过滤器可以区分不同的访问资源的方式，有不同的拦截方式。</p>
<p>dispatcher：访问的方式</p>
<ul>
<li><p>REQUEST：默认值，代表直接访问某个资源时执行filter</p>
</li>
<li><p>FORWARD：转发时才执行filter</p>
</li>
</ul>
<h3 id="1-1-6-过滤器链"><a href="#1-1-6-过滤器链" class="headerlink" title="1.1.6 过滤器链"></a>1.1.6 过滤器链</h3><h4 id="什么是过滤器链"><a href="#什么是过滤器链" class="headerlink" title="什么是过滤器链"></a>什么是过滤器链</h4><p>我们java代码中，有时需要对同一个请求，进行多次不同业务的过滤，所以我们java代码中需要多个过滤器。只有所有的过滤器都对请求进行了放行，请求才能访问到目标资源，只要多个过滤器中只有一个过滤器不放行请求，那么这个请求都不能够访问到目标资源。多个过滤器组成的一个整体我们称为过滤器链。而且，过滤器链中的过滤器是一个一个的执行的，一个过滤器执行完毕之后，会执行下一个过滤器，后面没有过滤器了，才会访问到目标资源。只要其中一个过滤器没有放行，那么这个过滤器后面的过滤器也都不会执行了</p>
<p>提示：</p>
<ol>
<li><p>web.xml配置的Filter的执行顺序取决于filter-mapping的顺序</p>
</li>
<li><p>注解配置的filter的执行顺序取决于filter的类名称的字母排序</p>
</li>
</ol>
<h3 id="1-1-7-过滤器的应用场景"><a href="#1-1-7-过滤器的应用场景" class="headerlink" title="1.1.7 过滤器的应用场景"></a>1.1.7 过滤器的应用场景</h3><ol>
<li><p>处理全站中文乱码</p>
</li>
<li><p>登录权限检查</p>
</li>
</ol>
<h2 id="1-2-监听器Listener"><a href="#1-2-监听器Listener" class="headerlink" title="1.2 监听器Listener"></a>1.2 监听器Listener</h2><h3 id="1-2-1-什么是监听器"><a href="#1-2-1-什么是监听器" class="headerlink" title="1.2.1 什么是监听器"></a>1.2.1 什么是监听器</h3><p>监听器就是监听某个对象的的状态变化的组件 监听器的相关概念： </p>
<p>事件源：被监听的对象 —- 主要三个域对象request session servletContext </p>
<p>监听器：监听事件源对象 事件源对象的状态的变化都会触发监听器 </p>
<p>响应行为：监听器监听到事件源的状态变化时 所涉及的功能代码 —- 程序员编写代码</p>
<h3 id="1-2-2-监听器有哪些"><a href="#1-2-2-监听器有哪些" class="headerlink" title="1.2.2 监听器有哪些"></a>1.2.2 监听器有哪些</h3><ol>
<li><p>第一维度：按照被监听的对象划分：ServletRequest域 HttpSession ServletContext域 </p>
</li>
<li><p>第二维度：安装监听的内容分：监听域对象的创建与销毁的监听域对象的属性变化的</p>
</li>
</ol>
<p>对应的接口：</p>
<p><img src="/2020/04/12/day41filter-listener-baseservlet/4.png" alt></p>
<p>代码实现：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span><span class="token punctuation">,</span>  HttpSessionListener<span class="token punctuation">,</span> ServletRequestAttributeListener <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">// Public constructor is required by servlet spec</span>
    <span class="token keyword">public</span> <span class="token function">MyListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// -------------------------------------------------------</span>
    <span class="token comment" spellcheck="true">// ServletContextListener implementation</span>
    <span class="token comment" spellcheck="true">// -------------------------------------------------------</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span>ServletContextEvent sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">/*
          此方法 ,在 ServletContext对象 ,初始化时调用执行.
      */</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyListener.contextInitialized"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"项目启动了,初始化信息..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span>ServletContextEvent sce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">/* 此方法 ,在 ServletContext对象 ,销毁时调用执行.
       */</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyListener.contextDestroyed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"项目关闭, 回收资源."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// -------------------------------------------------------</span>
    <span class="token comment" spellcheck="true">// HttpSessionListener implementation</span>
    <span class="token comment" spellcheck="true">// -------------------------------------------------------</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionCreated</span><span class="token punctuation">(</span>HttpSessionEvent se<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyListener.sessionCreated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"来客了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sessionDestroyed</span><span class="token punctuation">(</span>HttpSessionEvent se<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MyListener.sessionDestroyed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客走了,再来呀... 时间延迟..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeAdded</span><span class="token punctuation">(</span>ServletRequestAttributeEvent servletRequestAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeRemoved</span><span class="token punctuation">(</span>ServletRequestAttributeEvent servletRequestAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeReplaced</span><span class="token punctuation">(</span>ServletRequestAttributeEvent servletRequestAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="1-3-BaseServlet"><a href="#1-3-BaseServlet" class="headerlink" title="1.3 BaseServlet"></a>1.3 BaseServlet</h2><h3 id="1-3-1-什么是BaseServlet"><a href="#1-3-1-什么是BaseServlet" class="headerlink" title="1.3.1 什么是BaseServlet"></a>1.3.1 什么是BaseServlet</h3><p>为了解决Servlet类太多的问题</p>
<h3 id="1-3-2-BaseServlet的优化"><a href="#1-3-2-BaseServlet的优化" class="headerlink" title="1.3.2 BaseServlet的优化"></a>1.3.2 BaseServlet的优化</h3><h4 id="优化1"><a href="#优化1" class="headerlink" title="优化1"></a>优化1</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// localhost:8080/web14/user?method=pay&amp;name=tom&amp;money=100  --> pay方法</span>
    <span class="token comment" spellcheck="true">// localhost:8080/web14/user?method=updatePwd&amp;pwd=12345</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
         <span class="token comment" spellcheck="true">// 通过访问时, 客户端提供的参数, 分别调用不同的方法</span>
        String method <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"pay"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 调用pay方法</span>
            <span class="token function">pay</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"updatePwd"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 调用 updatePwd</span>
            <span class="token function">updatePwd</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"支付 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updatePwd</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"改密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="优化2"><a href="#优化2" class="headerlink" title="优化2"></a>优化2</h4><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/user2"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServlet2</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
         <span class="token comment" spellcheck="true">// 通过访问时, 客户端提供的参数, 分别调用不同的方法</span>
        String methodName <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 反射技术 ,替代 判断的写法 .</span>

        <span class="token comment" spellcheck="true">// 1. 获取本类的类对象</span>
        Class  <span class="token class-name">clz</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 2. 解析 Method</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//  暴力获取方法  , 非Public权限的方法 , 都必须这样才能获取到.</span>
            Method method <span class="token operator">=</span> clz<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">,</span> HttpServletRequest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> HttpServletResponse<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 3. 执行此方法</span>
            method<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 设置访问权限.</span>

            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span>request <span class="token punctuation">,</span> response <span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"支付 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updatePwd</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"改密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="优化3"><a href="#优化3" class="headerlink" title="优化3"></a>优化3</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseServlet</span>  <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span><span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest req<span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 通过访问时, 客户端提供的参数, 分别调用不同的方法</span>
        String methodName <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 反射技术 ,替代 判断的写法 .</span>

        <span class="token comment" spellcheck="true">// 1. 获取本类的类对象</span>
        Class  <span class="token class-name">clz</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 2. 解析 Method</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//  暴力获取方法  , 非Public权限的方法 , 都必须这样才能获取到.</span>
            Method method <span class="token operator">=</span> clz<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">,</span> HttpServletRequest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> HttpServletResponse<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 3. 执行此方法</span>
            method<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 设置访问权限.</span>

            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span>request <span class="token punctuation">,</span> response <span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">"/user3"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServlet3</span> <span class="token keyword">extends</span> <span class="token class-name">BaseServlet</span> <span class="token punctuation">{</span>


    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"支付 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updatePwd</span><span class="token punctuation">(</span>HttpServletRequest req <span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"改密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>优化图解<br><img src="/2020/04/12/day41filter-listener-baseservlet/5.jpg" alt></p>
<p>优化思路：抽象，反射，继承</p>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/2020/04/12/day42jdbc-tiao-jian-cha-xun-fen-ye/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            day42jdbc条件查询-分页
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2020/04/06/day40el-jstl/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">day40el-jstl</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: '',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        清风伴酒
      
    </h3>
    <p class="avatar-slogan">
      进击的后端渣渣
    </p>
  </div>
</div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/javaSE/">javaSE</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" rel="tag">编程语言</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 10px;">编程语言</a>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/12/day47-maven/">day46_maven</a>
          </li>
        
          <li>
            <a href="/2020/04/12/gong-han-mo-shi/">day46_maven</a>
          </li>
        
          <li>
            <a href="/2020/04/12/day46-redis/">day46_redis</a>
          </li>
        
          <li>
            <a href="/2020/04/12/day45-ajax-json/">day45-AJAX-Json</a>
          </li>
        
          <li>
            <a href="/2020/04/12/day44jquery-gao-ji/">day44jQuery高级</a>
          </li>
        
      </ul>
    </div>
  </div>

  
      <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
        <a style="display: block;" href="https://yiluyanxia.github.io/" title target='_blank'
        >一路眼瞎</a>
      
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 fantasy &nbsp;&nbsp;
    驱动于 <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank" rel="noopener">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之   阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>